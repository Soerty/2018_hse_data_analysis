---
title: "Homework"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```
```{r, include=FALSE}
library(tidyverse)
library(mosaic)
```

n = 125
k = 31
prior = 0.2861652226205915

### 1.1 Приведите результаты биномиального теста

```{r}
binomial_t <- binom.test(x = 31, n = 125, p = 0.286165222)
binomial_t
```
```{r}
probabilities <- c(0.28, 0.38)
density <- c(dbinom(x = 1:125, size = 125, prob = probabilities[1]),
             dbinom(x = 1:125, size = 125, prob = probabilities[2]))
params <- rep(paste("n = 125, p =", probabilities), each = 125)
id <- rep(1:125, 2)
binomials <- data_frame(density, params, id)
```

```{r}

binomials %>% 
  filter(params == "n = 125, p = 0.28") %>% 
  ggplot(aes(id, density))+
  geom_line()+
  geom_area(aes(x = ifelse(id>=qbinom(0.025, 125, 0.29) &
                           id<=qbinom(0.975, 125, 0.29), id, NA)),
            fill = "lightblue")+
  geom_vline(xintercept = 31, linetype = 2)+
  scale_x_continuous(breaks = c(0, 12, 19, 33,2:4*20))+
  theme_bw()+
  labs(title = "Биномиальное распределение с параметрами n = 125, p = 0.29",
       subtitle = "")
               
```



### 1.2 Приведите результаты симуляции, используя set.seed(42)

Симуляция на 1000
```{r}
set.seed(42)
do(1000)*
  sum(sample(x = 1:0, 
             size = 125, 
             prob = c(0.286165222, 1 - 0.286165222), 
             replace = TRUE)) ->
  simulations
simulations %>% 
  mutate(greater = sum >= 31) %>% 
  count(greater)
```

```{r}
simulations %>% 
  ggplot(aes(sum))+
  geom_density(fill = "lightblue")+
  geom_vline(xintercept = 31, linetype = 2)+
  theme_bw()+
  labs(title = "Распределение 1000 симуляций с параметрами n = 125, p = 0.29")
```

### 1.3 Приведите среднее апостериорного распределения, используя prior как средние априорного 
### распределения, а n как количество элементов для 
### вычисления апостериорного распределения.
```{r}
alpha_prior <- 0.286165222 * 125
beta_prior <- (1 - 0.286165222)
alpha_data <- 31
beta_data <- 125 - 31

alpha_post <- alpha_prior + alpha_data
beta_post <- beta_prior + beta_data

alpha_post/(alpha_post+beta_post)

```

### 1.4 Приведите среднее апостериорного распределения, используя неинформативное априорное распределение
При неинформативном априорном распределении aplpha = 1
и beta = 1; тогда отсюда следует, что
alpha_post = alpha_data + 1;
beta_post = beta_data + 1;
тогда среднее апостериорное:

```{r}
(alpha_data + 1)/(alpha_data + beta_data + 2)
```

### 1.5 Короткий абзац, который обобщает результаты.

В пункте 1.1, вероятность полученная по результатам биномиального теста, не значительно отличается от ожидаемой вероятности. (На ~0.05) 
Значит можно утверждать, что получение результата (x = 31) постоянно будет происходить с вероятностью около ~0.25. И ожидаемая вероятность была верна.
Проведя симуляцию в пункте 1.2 для функции суммирования, мы увидим, что график распределения из пункта 1.1 и график распределения из пункта 1.2 будут почти идентичны. И по ним видно, что полученные результаты симуляции и результаты биноминального теста, распределились с одинаковой вероятностью.
Средняя апостериорного распределения получилась равна ~0.4. Получается что средняя апостериорная вероятность будет ~0.4, это значительно отличается от нашей ожидаемой вероятности, однако, предполагается, что апостериорная вероятность выявляется, уже на результатах готовых экспериментов, а стало быть должна быть точнее, чем вероятность биноминального теста.
Если опираться на среднюю апостериорную вероятность, тогда ожидаемая p, будет неверна.


Если же использовать неинформативное априорное распределение для расчетов, то тогда результаты будут совпадать и с биноминальным тестом, и близки к ожиданиям.






